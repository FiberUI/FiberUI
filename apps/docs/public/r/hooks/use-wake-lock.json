{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-wake-lock",
  "type": "registry:hook",
  "title": "useWakeLock",
  "description": "A device hook for the Screen Wake Lock API.",
  "categories": [
    "device"
  ],
  "files": [
    {
      "path": "device/use-wake-lock.ts",
      "type": "registry:hook",
      "content": "import { useState, useCallback, useEffect, useRef } from \"react\";\n\n/**\n * Return type for the useWakeLock hook\n */\nexport interface UseWakeLockReturn {\n    /** Whether the wake lock is currently active */\n    isActive: boolean;\n    /** Whether the Screen Wake Lock API is supported */\n    isSupported: boolean;\n    /** Request a wake lock */\n    request: () => Promise<boolean>;\n    /** Release the wake lock */\n    release: () => Promise<boolean>;\n    /** Error from the last operation */\n    error: Error | null;\n}\n\n// Type definitions for Screen Wake Lock API\n// These are often already in lib.dom.d.ts but strictly typing local interfaces helps if libs are old\ninterface WakeLockSentinel extends EventTarget {\n    readonly released: boolean;\n    readonly type: \"screen\";\n    release(): Promise<void>;\n    onrelease: ((this: WakeLockSentinel, ev: Event) => void) | null;\n}\n\ninterface WakeLock {\n    request(type: \"screen\"): Promise<WakeLockSentinel>;\n}\n\n// Extend Navigator if not already defined correctly in environment\n// We use a safe augmentation or just cast usage\ndeclare global {\n    interface Navigator {\n        // Only add if not present, but TS merging rules make this hard if it conflicts.\n        // Best to just rely on usage casting if conflict exists.\n        // wakeLock?: WakeLock;\n    }\n}\n\n/**\n * A React hook that provides access to the Screen Wake Lock API,\n * allowing you to prevent the device screen from dimming or locking.\n *\n * @returns UseWakeLockReturn object with state and controls\n */\nexport function useWakeLock(): UseWakeLockReturn {\n    const [isActive, setIsActive] = useState(false);\n    const [error, setError] = useState<Error | null>(null);\n    const sentinelRef = useRef<WakeLockSentinel | null>(null);\n\n    // Check support\n    const isSupported =\n        typeof navigator !== \"undefined\" && \"wakeLock\" in navigator;\n\n    // Release function\n    const release = useCallback(async () => {\n        if (!sentinelRef.current) return false;\n\n        try {\n            await sentinelRef.current.release();\n            sentinelRef.current = null;\n            setIsActive(false);\n            return true;\n        } catch (err) {\n            const error =\n                err instanceof Error\n                    ? err\n                    : new Error(\"Failed to release lock\");\n            setError(error);\n            return false;\n        }\n    }, []);\n\n    // Request function\n    const request = useCallback(async () => {\n        if (!isSupported) {\n            setError(new Error(\"Screen Wake Lock API is not supported\"));\n            return false;\n        }\n\n        try {\n            const sentinel = await navigator.wakeLock!.request(\"screen\");\n            sentinelRef.current = sentinel;\n            setIsActive(true);\n            setError(null);\n\n            // Handle automatic release (e.g. user switches tabs)\n            sentinel.onrelease = () => {\n                // If it was released externally (not by us calling release())\n                // we should update state.\n                if (sentinelRef.current === sentinel) {\n                    // Released by system\n                    setIsActive(false);\n                    sentinelRef.current = null;\n                }\n            };\n\n            return true;\n        } catch (err) {\n            const error =\n                err instanceof Error\n                    ? err\n                    : new Error(\"Failed to request lock\");\n            setError(error);\n            return false;\n        }\n    }, [isSupported]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            if (sentinelRef.current) {\n                sentinelRef.current.release().catch(() => {});\n            }\n        };\n    }, []);\n\n    return {\n        isActive,\n        isSupported,\n        request,\n        release,\n        error,\n    };\n}\n\nexport default useWakeLock;\n"
    }
  ]
}