{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-geolocation",
  "type": "registry:hook",
  "title": "useGeolocation",
  "description": "A React hook for accessing the Geolocation API.",
  "categories": [
    "device"
  ],
  "files": [
    {
      "path": "device/use-geolocation.ts",
      "type": "registry:hook",
      "content": "import { useState, useEffect, useCallback, useRef } from \"react\";\n\n/**\n * Options for the useGeolocation hook\n */\nexport interface UseGeolocationOptions {\n    /** Enable continuous position updates (default: false) */\n    watch?: boolean;\n    /** Use high accuracy GPS (slower, more battery) vs Wi-Fi/Cell (faster, less accurate) */\n    enableHighAccuracy?: boolean;\n    /** Maximum age of a cached position in milliseconds (default: 0 - always fetch fresh) */\n    maximumAge?: number;\n    /** Timeout for position request in milliseconds (default: Infinity) */\n    timeout?: number;\n}\n\n/**\n * Geolocation state returned by the hook\n */\nexport interface GeolocationState {\n    /** Latitude in decimal degrees (e.g., 37.7749) */\n    latitude: number | null;\n    /** Longitude in decimal degrees (e.g., -122.4194) */\n    longitude: number | null;\n    /** Accuracy of the position in meters */\n    accuracy: number | null;\n    /** Altitude in meters above sea level (null if not available) */\n    altitude: number | null;\n    /** Accuracy of the altitude in meters (null if not available) */\n    altitudeAccuracy: number | null;\n    /** Direction of travel in degrees (0-360, null if not moving) */\n    heading: number | null;\n    /** Speed in meters per second (null if not moving) */\n    speed: number | null;\n    /** Timestamp when the position was acquired */\n    timestamp: number | null;\n    /** Whether the position is currently being fetched */\n    isLoading: boolean;\n    /** Whether the Geolocation API is supported */\n    isSupported: boolean;\n    /** Error object if position request failed */\n    error: GeolocationPositionError | null;\n    /** Error message for display (human-readable) */\n    errorMessage: string | null;\n    /** Manually request a position update */\n    refetch: () => void;\n    /** Stop watching for position updates (only in watch mode) */\n    clearWatch: () => void;\n}\n\n/**\n * Human-readable error messages for GeolocationPositionError codes\n */\nfunction getErrorMessage(error: GeolocationPositionError): string {\n    switch (error.code) {\n        case error.PERMISSION_DENIED:\n            return \"Location permission denied. Please allow access in your browser settings.\";\n        case error.POSITION_UNAVAILABLE:\n            return \"Position unavailable. Your device may not have GPS or location services enabled.\";\n        case error.TIMEOUT:\n            return \"Location request timed out. Please try again.\";\n        default:\n            return \"An unknown error occurred while getting your location.\";\n    }\n}\n\nconst initialState: Omit<GeolocationState, \"refetch\" | \"clearWatch\"> = {\n    latitude: null,\n    longitude: null,\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    speed: null,\n    timestamp: null,\n    isLoading: false,\n    isSupported: true,\n    error: null,\n    errorMessage: null,\n};\n\n/**\n * A React hook that provides the device's current geographic location using the\n * Geolocation API. Supports one-time position requests and continuous watching.\n *\n * @param options - Configuration options for the hook\n * @returns GeolocationState object with position data and control functions\n *\n * @example\n * ```tsx\n * // One-time position request\n * const { latitude, longitude, isLoading, error } = useGeolocation();\n *\n * // Continuous position updates\n * const { latitude, longitude } = useGeolocation({ watch: true });\n *\n * // High accuracy mode\n * const { latitude, longitude, accuracy } = useGeolocation({\n *     enableHighAccuracy: true,\n *     timeout: 10000\n * });\n * ```\n */\nexport function useGeolocation(\n    options: UseGeolocationOptions = {},\n): GeolocationState {\n    const {\n        watch = false,\n        enableHighAccuracy = false,\n        maximumAge = 0,\n        timeout = Infinity,\n    } = options;\n\n    const [state, setState] = useState(initialState);\n    const watchIdRef = useRef<number | null>(null);\n\n    // Check if API is supported\n    const isSupported =\n        typeof navigator !== \"undefined\" && \"geolocation\" in navigator;\n\n    // Success handler\n    const handleSuccess = useCallback((position: GeolocationPosition) => {\n        const { coords, timestamp } = position;\n        setState({\n            latitude: coords.latitude,\n            longitude: coords.longitude,\n            accuracy: coords.accuracy,\n            altitude: coords.altitude,\n            altitudeAccuracy: coords.altitudeAccuracy,\n            heading: coords.heading,\n            speed: coords.speed,\n            timestamp,\n            isLoading: false,\n            isSupported: true,\n            error: null,\n            errorMessage: null,\n        });\n    }, []);\n\n    // Error handler\n    const handleError = useCallback((error: GeolocationPositionError) => {\n        setState((prev) => ({\n            ...prev,\n            isLoading: false,\n            error,\n            errorMessage: getErrorMessage(error),\n        }));\n    }, []);\n\n    // Position options\n    const positionOptions: PositionOptions = {\n        enableHighAccuracy,\n        maximumAge,\n        timeout: timeout === Infinity ? undefined : timeout,\n    };\n\n    // Refetch function (manual position request)\n    const refetch = useCallback(() => {\n        if (!isSupported) return;\n\n        setState((prev) => ({\n            ...prev,\n            isLoading: true,\n            error: null,\n            errorMessage: null,\n        }));\n        navigator.geolocation.getCurrentPosition(\n            handleSuccess,\n            handleError,\n            positionOptions,\n        );\n    }, [\n        isSupported,\n        handleSuccess,\n        handleError,\n        enableHighAccuracy,\n        maximumAge,\n        timeout,\n    ]);\n\n    // Clear watch function\n    const clearWatch = useCallback(() => {\n        if (watchIdRef.current !== null) {\n            navigator.geolocation.clearWatch(watchIdRef.current);\n            watchIdRef.current = null;\n        }\n    }, []);\n\n    useEffect(() => {\n        if (!isSupported) {\n            setState((prev) => ({\n                ...prev,\n                isSupported: false,\n                isLoading: false,\n            }));\n            return;\n        }\n\n        setState((prev) => ({ ...prev, isLoading: true }));\n\n        if (watch) {\n            // Watch mode - continuous updates\n            watchIdRef.current = navigator.geolocation.watchPosition(\n                handleSuccess,\n                handleError,\n                positionOptions,\n            );\n        } else {\n            // One-time position request\n            navigator.geolocation.getCurrentPosition(\n                handleSuccess,\n                handleError,\n                positionOptions,\n            );\n        }\n\n        return () => {\n            if (watchIdRef.current !== null) {\n                navigator.geolocation.clearWatch(watchIdRef.current);\n                watchIdRef.current = null;\n            }\n        };\n    }, [\n        isSupported,\n        watch,\n        handleSuccess,\n        handleError,\n        enableHighAccuracy,\n        maximumAge,\n        timeout,\n    ]);\n\n    return {\n        ...state,\n        isSupported,\n        refetch,\n        clearWatch,\n    };\n}\n\nexport default useGeolocation;\n"
    }
  ]
}